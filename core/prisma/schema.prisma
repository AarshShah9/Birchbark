// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

generator client {
  provider = "prisma-client-js"
}



// Models
model User {
  id       Int       @id @default(autoincrement())
  email    String    @unique
  password String
  name     String?
  role     UserRole
  clinicId String?
  clinic   Clinic?   @relation("UserToClinic", fields: [clinicId], references: [clinicId])
  chatsAsDoctor Chat[] @relation("DoctorChat")
  chatsAsPatient Chat[] @relation("PatientChat")
  messages Message[] @relation("UserMessages")
}

enum UserRole {
  DOCTOR
  PATIENT
}

model Clinic {
  clinicId String    @id @default(cuid())
  name     String
  address  String
  city     String
  users    User[]    @relation("UserToClinic")
}

model Chat {
  id        Int       @id @default(autoincrement())
  doctorId  Int
  patientId Int
  doctor    User      @relation("DoctorChat", fields: [doctorId], references: [id])
  patient   User      @relation("PatientChat", fields: [patientId], references: [id])
  messages  Message[]
  createdAt DateTime  @default(now())
}

model Message {
  id              Int       @id @default(autoincrement())
  content         String
  senderId        Int      
  sender          User      @relation("UserMessages", fields: [senderId], references: [id])
  chatId          Int
  chat            Chat      @relation(fields: [chatId], references: [id])
  createdAt       DateTime  @default(now())
}
